const expressions = [
    //0 : 345
    [
        "6-5+4-7+2",
        "6%5+4-7+2",
        "6-5%4-7+2",
        "6&5%4*7+2",
        "6-5&4*7+2",
        "6/5&4*7+2",
        "6%5&4*7+2",
        "6-5&4/7+2",
        "6/5&4/7+2",
        "6%5&4/7+2",
    ],
    //1 : 132
    [
        "6-5&4+7+2",
        "6/5&4+7+2",
        "6%5&4+7+2",
        "6-5&4-7+2",
        "6/5&4-7+2",
        "6%5&4-7+2",
        "6-5%4*7+2",
        "6-5+4&7+2",
        "6/5+4&7+2",
        "6%5+4&7+2",
    ],
    //2 : 220
    [
        "6&5+4+7+2",
        "6&5-4+7+2",
        "6&5/4+7+2",
        "6&5%4+7+2",
        "6+5-4-7+2",
        "6+5%4-7+2",
        "6&5+4*7+2",
        "6&5-4*7+2",
        "6&5/4*7+2",
        "6&5/4/7+2",
    ],
    //3 : 69
    [
        "6-5|4/7+2",
        "6/5|4/7+2",
        "6%5|4/7+2",
        "6*5*4%7+2",
        "6%5%4%7+2",
        "6-5+4%7-2",
        "6%5+4%7-2",
        "6-5%4%7-2",
        "6-5|4%7-2",
        "6/5|4%7-2",
    ],
    //4 : 80
    [
        "6&5*4+7+2",
        "6&5&4+7+2",
        "6&5+4-7+2",
        "6&5-4-7+2",
        "6&5/4-7+2",
        "6&5%4-7+2",
        "6&5&4-7+2",
        "6*5-4*7+2",
        "6&5&4*7+2",
        "6&5*4/7+2",
    ],
    //5 : 68
    [
        "6%5%4*7-2",
        "6+5-4%7-2",
        "6+5%4%7-2",
        "6+5+4&7-2",
        "6-5+4&7-2",
        "6/5+4&7-2",
        "6%5+4&7-2",
        "6+5-4&7-2",
        "6-5-4&7-2",
        "6%5-4&7-2",
    ],
    //6 : 209
    [
        "6-5-4+7+2",
        "6%5-4+7+2",
        "6|5+4-7+2",
        "6&5*4-7+2",
        "6&5*4*7+2",
        "6|5&4*7+2",
        "6&5+4/7+2",
        "6&5-4/7+2",
        "6|5-4/7+2",
        "6|5*4/7+2",
    ],
    //7 : 223
    [
        "6|5&4+7+2",
        "6|5&4-7+2",
        "6|5+4/7+2",
        "6|5|4/7+2",
        "6-5+4%7+2",
        "6%5+4%7+2",
        "6|5-4%7+2",
        "6|5/4%7+2",
        "6-5%4%7+2",
        "6|5%4%7+2",
    ],
    //8 : 13
    [
        "6*5-4&7+2",
        "6/5-4&7+2",
        "6+5*4&7+2",
        "6*5*4&7+2",
        "6*5&4+7-2",
        "6+5&4*7*2",
        "6%5*4%7*2",
        "6+5%4%7*2",
        "6+5&4%7*2",
        "6*5&4%7*2",
    ],
    //9 : 31
    [
        "6+5&4+7+2",
        "6%5%4*7+2",
        "6+5-4%7+2",
        "6+5%4%7+2",
        "6+5+4&7+2",
        "6-5-4&7+2",
        "6%5-4&7+2",
        "6&5+4|7+2",
        "6&5-4|7+2",
        "6/5/4|7+2",
    ],
    //10 : 19
    [
        "6%5%4+7+2",
        "6+5+4-7+2",
        "6+5&4*7+2",
        "6-5+4+7-2",
        "6%5+4+7-2",
        "6-5%4+7-2",
        "6+5&4*7-2",
        "6+5*4%7-2",
        "6*5-4&7*2",
        "6+5*4&7*2",
    ],
    //11 : 46
    [
        "6*5%4+7+2",
        "6+5&4-7+2",
        "6+5|4/7+2",
        "6+5|4&7+2",
        "6*5%4|7+2",
        "6+5|4+7-2",
        "6+5&4-7-2",
        "6+5%4*7-2",
        "6+5&4/7-2",
        "6+5|4%7-2",
    ],
    //12 : 9
    [
        "6*5&4+7+2",
        "6+5-4+7-2",
        "6+5%4+7-2",
        "6*5%4*7-2",
        "6*5-4-7*2",
        "6+5*4-7*2",
        "6&5|4%7*2",
        "6-5-4&7*2",
        "6%5-4&7*2",
    ],
    //13 : 22
    [
        "6%5*4+7+2",
        "6-5|4+7+2",
        "6/5|4+7+2",
        "6%5|4+7+2",
        "6&5|4+7+2",
        "6-5+4|7+2",
        "6/5+4|7+2",
        "6%5+4|7+2",
        "6/5*4|7+2",
        "6%5*4|7+2",
    ],
    //14 : 57
    [
        "6-5+4+7+2",
        "6%5+4+7+2",
        "6|5-4+7+2",
        "6|5/4+7+2",
        "6-5%4+7+2",
        "6|5%4+7+2",
        "6|5/4*7+2",
        "6+5*4%7+2",
        "6|5*4%7+2",
        "6|5+4+7-2",
    ],
    //15 : 82
    [
        "6+5|4+7+2",
        "6|5|4+7+2",
        "6|5*4-7+2",
        "6+5%4*7+2",
        "6|5%4*7+2",
        "6|5+4%7+2",
        "6+5|4%7+2",
        "6|5+4&7+2",
        "6+5+4|7+2",
        "6|5+4|7+2",
    ],
    //16 : 6
    [
        "6+5-4+7+2",
        "6+5%4+7+2",
        "6*5%4*7+2",
        "6*5%4+7*2",
        "6*5-4*7/2",
        "6+5+4+7%2",
    ],
    //17 : 3
    [
        "6+5+4%7+2",
        "6*5-4-7-2",
        "6+5*4-7-2",
    ],
    //18 : 3
    [
        "6%5*4+7*2",
        "6*5&4+7*2",
        "6+5*4%7*2",
    ],
    //19 : 10
    [
        "6-5+4+7*2",
        "6%5+4+7*2",
        "6-5%4+7*2",
        "6-5|4+7*2",
        "6/5|4+7*2",
        "6%5|4+7*2",
        "6+5+4%7*2",
        "6*5-4-7|2",
        "6+5*4-7|2",
        "6*5*4/7|2",
    ],
    //20 : 3
    [
        "6+5+4+7-2",
        "6*5+4-7*2",
        "6+5%4*7*2",
    ],
    //21 : 4
    [
        "6*5-4-7+2",
        "6+5*4-7+2",
        "6+5-4+7*2",
        "6+5%4+7*2",
    ],
    //22 : 8
    [
        "6|5+4+7+2",
        "6&5|4+7*2",
        "6*5&4-7*2",
        "6*5-4%7*2",
        "6|5*4-7/2",
        "6|5*4|7&2",
        "6+5+4+7|2",
        "6|5+4+7|2",
    ],
    //23 : 11
    [
        "6|5*4|7-2",
        "6|5+4+7*2",
        "6|5|4+7*2",
        "6|5/4*7*2",
        "6|5*4+7/2",
        "6|5+4*7/2",
        "6|5*4|7/2",
        "6|5*4+7%2",
        "6|5*4-7%2",
        "6|5*4|7%2",
    ],
    //24 : 3
    [
        "6+5+4+7+2",
        "6*5-4%7-2",
        "6*5&4*7*2",
    ],
    //25 : 4
    [
        "6*5+4-7-2",
        "6+5+4*7/2",
        "6*5-4-7%2",
        "6+5*4-7%2",
    ],
    //26 : 6
    [
        "6*5&4-7-2",
        "6%5*4*7-2",
        "6*5&4*7-2",
        "6*5-4|7&2",
        "6+5*4|7&2",
        "6*5-4%7|2",
    ],
    //27 : 16
    [
        "6*5-4|7+2",
        "6+5*4|7+2",
        "6-5+4*7-2",
        "6%5+4*7-2",
        "6+5|4*7-2",
        "6-5|4*7-2",
        "6/5|4*7-2",
        "6%5|4*7-2",
        "6+5|4+7*2",
        "6*5-4|7/2",
    ],
    //28 : 3
    [
        "6*5-4%7+2",
        "6*5%4*7*2",
        "6*5-4%7/2",
    ],
    //29 : 2
    [
        "6*5+4-7+2",
        "6+5+4+7*2",
    ],
    //30 : 49
    [
        "6*5&4-7+2",
        "6%5*4*7+2",
        "6*5&4*7+2",
        "6*5|4*7+2",
        "6&5|4*7+2",
        "6*5|4/7+2",
        "6*5|4%7+2",
        "6*5|4&7+2",
        "6*5|4*7-2",
        "6&5|4*7-2",
    ],
    //31 : 40
    [
        "6|5*4+7+2",
        "6*5|4+7+2",
        "6-5+4*7+2",
        "6%5+4*7+2",
        "6+5|4*7+2",
        "6-5|4*7+2",
        "6/5|4*7+2",
        "6%5|4*7+2",
        "6|5|4*7+2",
        "6|5*4|7+2",
    ],
    //32 : 2
    [
        "6*5+4%7-2",
        "6*5+4%7/2",
    ],
    //33 : 1
    [
        "6*5+4-7%2",
    ],
    //34 : 2
    [
        "6*5+4|7&2",
        "6*5+4%7|2",
    ],
    //35 : 8
    [
        "6*5-4+7+2",
        "6+5*4+7+2",
        "6*5+4|7/2",
        "6*5+4+7%2",
        "6*5+4|7%2",
        "6*5-4+7|2",
        "6+5*4+7|2",
        "6/5*4*7|2",
    ],
    //36 : 1
    [
        "6*5+4%7+2",
    ],
    //37 : 1
    [
        "6+5+4*7-2",
    ],
    //38 : 2
    [
        "6|5*4+7*2",
        "6*5+4%7*2",
    ],
    //39 : 6
    [
        "6|5+4*7+2",
        "6*5+4+7-2",
        "6*5+4|7-2",
        "6+5+4*7|2",
        "6|5+4*7|2",
        "6*5+4|7|2",
    ],
    //40 : 2
    [
        "6*5-4+7*2",
        "6+5*4+7*2",
    ],
    //41 : 1
    [
        "6+5+4*7+2",
    ],
    //42 : 
    [
        "(6|5&4)*7|2",
        "6*(5-4)*7|2"
    ],
    //43 : 3
    [
        "6*5+4+7+2",
        "6*5+4|7+2",
        "6*5+4+7|2",
    ],
    //44 : 1
    [
        "6*5+4*7/2",
    ],
    //45 : 4
    [
        "-6-5+4*7*2",
        "6-5|4+7<<2",
        "6/5|4+7<<2",
        "6%5|4+7<<2",
    ],
    //46 : 1
    [
        "6*5+4|7*2",
    ],
    //47 : 2
    [
        "6+5|4+7<<2",
        "6|5|4+7<<2",
    ],
    //48 : 1
    [
        "6*5+4+7*2",
    ],
    //49 : 
    [
        "(6+5)*4+7-2"
    ],
    //50 : 
    [
        "6*5+4*(7-2)"
    ],
    //51 : 1
    [
        "!6-5+4*7*2",
    ],
    //52 : 3
    [
        "6*5-4<<7%2",
        "6+5*4<<7%2",
        "6+5%4*7<<2",
    ],
    //53 : 
    [
        (6 + 5) * 4 + 7 + 2
    ],
    //54 : 1
    [
        "6*5/4*7|2",
    ],
    //55 : 2
    [
        "-6+5+4*7*2",
        "-6%5+4*7*2",
    ],
    //56 : 2
    [
        "6*5+4*7-2",
        "6%5*4*7*2",
    ],
    //57 : 5
    [
        "6-5+4*7*2",
        "6%5+4*7*2",
        "6-5|4*7*2",
        "6/5|4*7*2",
        "6%5|4*7*2",
    ],
    //58 : 1
    [
        "6*5+4*7|2",
    ],
    //59 : 1
    [
        "6+5|4*7*2",
    ],
    //60 : 2
    [
        "6*5+4*7+2",
        "6&5|4*7*2",
    ],
    //61 : 4
    [
        "!6+5+4*7*2",
        "!6|5+4*7*2",
        "!6+5|4*7*2",
        "!6|5|4*7*2",
    ],
    //62 : 1
    [
        "6*5|4*7*2",
    ],
    //63 : 2
    [
        "6|5+4*7*2",
        "6|5|4*7*2",
    ],
    //64 : 5
    [
        "6-5<<4%7+2",
        "6/5<<4%7+2",
        "6%5<<4%7+2",
        "6*5%4<<7-2",
        "-6+5*4*7/2",
    ],
    //65 : 
    [
        "(!6+5+4)*7+2"
    ],
    //66 : 1
    [
        "-6&5*4*7/2",
    ],
    //67 : 1
    [
        "6+5+4*7*2",
    ],
    //68 : 2
    [
        "6*5+4<<7%2",
        "6*5*4/7<<2",
    ],
    //69 : 
    [
        "6*(5*4|7)/2"
    ],
    //70 : 1
    [
        "6|5*4*7/2",
    ],
    //71
    [
        "6*5*4-7**2"
    ],
    //72 : 3
    [
        "!6+5+4<<7/2",
        "-6&5+4<<7/2",
        "!6|5+4<<7/2",
    ],
    //73 : 
    [
        "(6+!5+4)*7-~2"
    ],
    //74 : 
    [
        "(6+5+!4)*7+~2"
    ],
    //75 : 
    [
        "(6+5+!4)*7-2"
    ],
    //76 : 1
    [
        "6+5*4*7/2",
    ],
    //77 : 
    [
        "(6+5+!4)*7+!2"
    ],
    //78 : 1
    [
        "6|5+4<<7/2",
    ],
    //79 : 
    [
        "(6+5+!4)*7+2"
    ],
    //80 : 
    [
        "!6+5*4*(-~7)/2"
    ],
    //81 : 3
    [
        "!6+5<<4|7%2",
        "-6&5<<4|7%2",
        "!6|5<<4|7%2",
    ],
    //82 : 6
    [
        "!6+5<<4|7&2",
        "-6&5<<4|7&2",
        "!6|5<<4|7&2",
        "!6+5<<4%7|2",
        "-6&5<<4%7|2",
        "!6|5<<4%7|2",
    ],
    //83 : 3
    [
        "!6+5<<4|7/2",
        "-6&5<<4|7/2",
        "!6|5<<4|7/2",
    ],
    //84 : 1
    [
        "-6+5*4+7<<2",
    ],
    //85 : 3
    [
        "!6+5<<4|7-2",
        "-6&5<<4|7-2",
        "!6|5<<4|7-2",
    ],
    //86 : 1
    [
        "6*5+4*7*2",
    ],
    //87 : 4
    [
        "6|5<<4|7-2",
        "6|5<<4|7/2",
        "6|5<<4|7%2",
        "6|5<<4|7|2",
    ],
    //88 : 2
    [
        "6+5<<4-7%2",
        "6+5+4+7<<2",
    ],
    //89 : 3
    [
        "!6+5<<4|7+2",
        "-6&5<<4|7+2",
        "!6|5<<4|7+2",
    ],
    //90 : 
    [
        "6*5*(-4+7)|2"
    ],
    //91 : 
    [
        "6*(5+4|7)+!!2"
    ],
    //92 : 1
    [
        "!6-5+4*7<<2",
    ],
    //93 : 
    [
        "6*(5+4|7)-~2"
    ],
    //94 : 1
    [
        "6|5<<4|7*2",
    ],
    //95 : 1
    [
        "6|5<<4|7+2",
    ],
    //96 : 9
    [
        "6<<5+4-7+2",
        "6<<5*4/7+2",
        "6<<5*4%7-2",
        "6<<5-4+7/2",
        "6<<5/4+7/2",
        "6<<5%4+7/2",
        "6<<5/4*7/2",
        "6<<5-4/7/2",
        "6<<5-4/7%2",
    ],
    //97 : 
    [
        "6*(5+4+7)+!!2"
    ],
    //98 : 1
    [
        "6<<5-4/7|2",
    ],
    //99 : 
    [
        "(6+5)*(!4+7+2)"
    ],
    //100 : 
    [
        "(6+!5+4+!7)**2"
    ],
    //101
    [
        "!!6+5*4*(7-2)"
    ],
    //102 : 
    [
        "(6|5+4)*7+~2"
    ],
    //103 : 
    [
        "(6|5+4)*7-2"
    ],
    //104 : 1
    [
        "6*5-4%7<<2",
    ],
    //105 : 1
    [
        "6*5/4*7*2",
    ],
    //106 : 1
    [
        "6*5*4-7*2",
    ],
    //107 : 
    [
        "(6+5|4)*7+2"
    ],
    //108 : 1
    [
        "6*5+4-7<<2",
    ],
    //109 : 
    [
        "6*(5-~4)+7**2"
    ],
    //110 : 1
    [
        "6|5*4+7<<2",
    ],
    //111 : 1
    [
        "6*5*4-7-2",
    ],
    //112 : 1
    [
        "6%5*4*7<<2",
    ],
    //113 : 3
    [
        "6-5|4*7<<2",
        "6/5|4*7<<2",
        "6%5|4*7<<2",
    ],
    //114 : 
    [
        "6*5*4+(7^~2)"
    ],
    //115 : 2
    [
        "6*5*4-7+2",
        "6*5*4-7|2",
    ],
    //116 : 5
    [
        "6-5+4*7<<2",
        "6/5+4*7<<2",
        "6%5+4*7<<2",
        "6&5|4*7<<2",
        "6*5-4/7<<2",
    ],
    //117 : 2
    [
        "!6+5|4*7<<2",
        "!6|5|4*7<<2",
    ],
    //118 : 
    [
        "6*5*4+!7-2"
    ],
    //119 : 1
    [
        "6*5*4-7%2",
    ],
    //120 : 5
    [
        "6*5<<4/7+2",
        "6*5<<4%7-2",
        "6*5<<4%7/2",
        "6+5+4<<7/2",
        "6*5+4/7<<2",
    ],
    //121 : 3
    [
        "6*5*4|7+2",
        "6*5*4+7%2",
        "6*5*4|7%2",
    ],
    //122 : 1
    [
        "6*5*4|7&2",
    ],
    //123 : 1
    [
        "6*5*4|7/2",
    ],
    //124 : 1
    [
        "6*5*4|7<<2",
    ],
    //125 : 2
    [
        "6*5*4+7-2",
        "6*5*4|7-2",
    ],
    //126 : 1
    [
        "6*5*4|7*2",
    ],
    //127 : 2
    [
        "6*5*4+7|2",
        "6*5*4|7|2",
    ],
    //128 : 6
    [
        "6/5*4<<7-2",
        "6%5*4<<7-2",
        "6-5/4<<7-2",
        "6-5<<4+7/2",
        "6/5<<4+7/2",
        "6%5<<4+7/2",
    ]
];

const dictionary = [
    "taenia solium",
    "pork sushi",
    "measly pork",
    "bug",
    "chen jie",
    "censor",
    "lockdown",
    "red blue red blue red",
    "peng zhengwei",
    "orange coded heat alert",
    "consist training for three years",
    "susceptible students"
]

function findAExpressionFor(n) {
    if (!expressions[n]) {
        return n;
    }
    var available = expressions[n];
    return available[Math.floor(Math.random() * available.length)];
}

function encodeIntoArray(str) {
    var ret = [];
    for (i in str) {
        var n = str.charCodeAt(i);
        if (n < 128) {
            ret.push(findAExpressionFor(n));
        } else {
            var sa = [];
            while (n >= 128) {
                sa.push(findAExpressionFor(n % 128));
                n -= n % 128;
                n /= 128;
            }
            sa.push(findAExpressionFor(n));
            ret.push("[" + sa.join() + "]");
        }
    }
    return "[" + ret.join() + "]";
}

function decodeFromArray(arr) {
    var str = [];
    for (i in arr) {
        var n = arr[i];
        if (n.length) {
            n = 0;
            for (j in arr[i]) {
                n += 128 ** j * arr[i][j];
            }
        }
        str.push(String.fromCharCode(n));
    }
    return str.join("");
}

function selectWord(str) {
    function selectCharacter(ch) {
        var offset = Math.floor(Math.random() * dictionary.length);
        for (i in dictionary) {
            var io = (i + offset) % dictionary.length;
            var pos = dictionary[io].indexOf(ch);
            if (pos >= 0) {
                return `"${dictionary[io]}"[${findAExpressionFor(pos)}]`;
            }
            var pos2 = dictionary[io].toUpperCase().indexOf(ch);
            if (pos2 >= 0) {
                return `"${dictionary[io].toUpperCase()}"[${findAExpressionFor(pos2)}]`;
            }
        }
        return `"${ch}"`;
    }
    var ret = [];
    for (i in str) {
        ret.push(selectCharacter(str[i]));
    }
    return ret.join("+");
}

function generateEncodedDecoder() {
    return `
(_6,_5,_4,_7,_2)=>{
    var _5=[];
    for (_4 in _6){
        var _7=_6[_4];
        if (_7[${selectWord("length")}]) {
            _7=0;
            for (_2 in _6[_4]) {
                _7+=(${findAExpressionFor(128)})**_2*_6[_4][_2];
            }
        }
        _5[${selectWord("push")}](this[${selectWord("String")}][${selectWord("fromCharCode")}](_7));
    }
    (${findAExpressionFor(0)})[${selectWord("constructor")}][${selectWord("constructor")}](_5[${selectWord("join")}](""))();
}
`.replaceAll(/\n\s*/g, "");
}

function generateEncryptedScript(str) {
    return `(${generateEncodedDecoder()})(${encodeIntoArray(str)});`;
}

function check(){
    for(i in expressions){
        for(j in expressions[i]){
            if(eval(expressions[i][j]) != i){
                console.log(i + " " + j);
            }
        }
    }
}